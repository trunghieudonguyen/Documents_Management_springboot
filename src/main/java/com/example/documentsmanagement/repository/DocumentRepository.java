package com.example.documentsmanagement.repository;


import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import com.example.documentsmanagement.model.Document;
import java.util.List;


public interface DocumentRepository extends JpaRepository<Document, Long> {

    // üîç T√¨m ki·∫øm theo ti√™u ƒë·ªÅ ho·∫∑c m√¥ t·∫£ (kh√¥ng ph√¢n bi·ªát hoa th∆∞·ªùng)
    @Query("SELECT d FROM Document d " +
            "WHERE LOWER(d.title) LIKE LOWER(CONCAT('%', :keyword, '%')) " +
            "   OR LOWER(d.description) LIKE LOWER(CONCAT('%', :keyword, '%')) " +
            "   OR LOWER(d.documentCode) LIKE LOWER(CONCAT('%', :keyword, '%'))")
    List<Document> searchByTitle(@Param("keyword") String keyword);

    // üîç Ki·ªÉm tra t·ªìn t·∫°i theo m√£ t√†i li·ªáu
    boolean existsByDocumentCode(String documentCode);

    // üîç L·∫•y danh s√°ch t√†i li·ªáu theo tr·∫°ng th√°i
    List<Document> findByStatus(String status);

    // üîç L·∫•y danh s√°ch t√†i li·ªáu theo ph√≤ng ban
    List<Document> findByDepartment(String department);

    // üîç L·∫•y danh s√°ch t√†i li·ªáu theo m√£ danh m·ª•c
    @Query("SELECT d FROM Document d WHERE d.category.idDocumentCategory = :categoryId")
    List<Document> findByCategoryId(@Param("categoryId") Long categoryId);
}